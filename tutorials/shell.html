<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="{{DESCRIPTION}}" />
        <title>{{TITLE}}</title>

        <link rel="canonical" href="{{URL}}" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="{{URL}}" />
        <meta property="og:title" content="{{TITLE}}" />
        <meta property="og:description" content="{{DESCRIPTION}}" />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:title" content="{{TITLE}}" />
        <meta name="twitter:description" content="{{DESCRIPTION}}" />

        <link rel="stylesheet" href="/styles/shell.css" />

        <!-- Theme: apply before paint to prevent flash -->
        <script>
            (function () {
                var t = localStorage.getItem("vlist-theme");
                if (!t)
                    t = window.matchMedia("(prefers-color-scheme: light)")
                        .matches
                        ? "light"
                        : "dark";
                document.documentElement.setAttribute("data-theme", t);
            })();
        </script>

        <style>
            /* ─── Docs Token Overrides ───────────────────────── */

            :root {
                --bg-code: #18181e;
                --bg-code-inline: #1c1c24;
                --radius-sm: 5px;
            }

            [data-theme="light"] {
                --bg-code: #f0f0f5;
                --bg-code-inline: #eaeaf0;
            }

            /* ─── Markdown body ──────────────────────────────── */

            .md {
                max-width: 820px;
                margin: 0 auto;
                padding: 40px 48px 80px;
                overflow-wrap: break-word;
                word-wrap: break-word;
            }

            .md h1 {
                font-size: 36px;
                font-weight: 700;
                letter-spacing: -0.5px;
                margin-bottom: 8px;
                padding-bottom: 12px;
                border-bottom: 1px solid var(--border);
            }

            .md h2 {
                font-size: 27px;
                font-weight: 650;
                margin-top: 48px;
                margin-bottom: 16px;
                padding-bottom: 8px;
                border-bottom: 1px solid var(--border);
                letter-spacing: -0.3px;
            }

            .md h3 {
                font-size: 21px;
                font-weight: 600;
                margin-top: 32px;
                margin-bottom: 12px;
            }

            .md h4 {
                font-size: 17px;
                font-weight: 600;
                margin-top: 24px;
                margin-bottom: 8px;
                color: var(--text-muted);
            }

            .md h1:first-child {
                margin-top: 0;
            }

            .md h2:first-child {
                margin-top: 0;
            }

            /* Anchor links on headings */
            .md h1 .anchor,
            .md h2 .anchor,
            .md h3 .anchor,
            .md h4 .anchor {
                color: var(--text-dim);
                text-decoration: none;
                margin-left: 6px;
                opacity: 0;
                transition: opacity 0.15s;
                font-weight: 400;
            }

            .md h1:hover .anchor,
            .md h2:hover .anchor,
            .md h3:hover .anchor,
            .md h4:hover .anchor {
                opacity: 1;
            }

            .md p {
                margin-bottom: 16px;
                color: var(--text-muted);
                line-height: 1.7;
            }

            .md blockquote {
                border-left: 3px solid var(--accent);
                padding: 8px 16px;
                margin-bottom: 16px;
                background: var(--accent-dim);
                border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            }

            .md blockquote p {
                color: var(--text-muted);
                margin-bottom: 0;
            }

            .md strong {
                font-weight: 600;
                color: var(--text);
            }

            .md a {
                color: var(--accent-text);
                text-decoration: none;
            }

            .md a:hover {
                text-decoration: underline;
            }

            .md ul,
            .md ol {
                margin-bottom: 16px;
                padding-left: 24px;
                color: var(--text-muted);
            }

            .md li {
                margin-bottom: 4px;
                line-height: 1.7;
            }

            .md li > ul,
            .md li > ol {
                margin-top: 4px;
                margin-bottom: 4px;
            }

            .md hr {
                border: none;
                border-top: 1px solid var(--border);
                margin: 32px 0;
            }

            /* ─── Code ───────────────────────────────────────── */

            .md code {
                font-family:
                    "SF Mono", Monaco, Menlo, "Cascadia Code", "Consolas",
                    monospace;
                font-size: 0.88em;
                background: var(--bg-code-inline);
                padding: 2px 7px;
                border-radius: 4px;
                color: #c8cedc;
            }

            [data-theme="light"] .md code {
                color: #374151;
            }

            .md pre {
                background: var(--bg-code);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                padding: 16px 20px;
                margin-bottom: 16px;
                overflow-x: auto;
                line-height: 1.55;
            }

            .md pre::-webkit-scrollbar {
                height: 4px;
            }

            .md pre::-webkit-scrollbar-track {
                background: transparent;
            }

            .md pre::-webkit-scrollbar-thumb {
                background: var(--border);
                border-radius: 2px;
            }

            .md pre code {
                background: none;
                padding: 0;
                border-radius: 0;
                font-size: 16px;
                color: #c8cedc;
            }

            [data-theme="light"] .md pre code {
                color: #374151;
            }

            /* ─── Tables ─────────────────────────────────────── */

            .md table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 16px;
                font-size: 16px;
            }

            .md thead th {
                text-align: left;
                font-weight: 600;
                color: var(--text);
                padding: 8px 12px;
                border-bottom: 2px solid var(--border);
                font-size: 15px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .md tbody td {
                padding: 8px 12px;
                border-bottom: 1px solid var(--border);
                color: var(--text-muted);
                vertical-align: top;
            }

            .md tbody tr:last-child td {
                border-bottom: none;
            }

            .md tbody tr:hover {
                background: rgba(255, 255, 255, 0.02);
            }

            .md tbody td code {
                font-size: 15px;
            }

            /* ─── Syntax highlighting (manual dark theme) ──── */

            .hljs-keyword,
            .hljs-selector-tag,
            .hljs-built_in,
            .hljs-type {
                color: #c792ea;
            }

            .hljs-string,
            .hljs-attr {
                color: #c3e88d;
            }

            .hljs-number,
            .hljs-literal {
                color: #f78c6c;
            }

            .hljs-comment {
                color: #546e7a;
                font-style: italic;
            }

            .hljs-function .hljs-title,
            .hljs-title.function_ {
                color: #82aaff;
            }

            .hljs-variable,
            .hljs-template-variable {
                color: #eeffff;
            }

            .hljs-params {
                color: #c8cedc;
            }

            /* ─── Syntax: light theme ────────────────────────── */

            [data-theme="light"] .hljs-keyword,
            [data-theme="light"] .hljs-selector-tag,
            [data-theme="light"] .hljs-built_in,
            [data-theme="light"] .hljs-type {
                color: #7c3aed;
            }

            [data-theme="light"] .hljs-string,
            [data-theme="light"] .hljs-attr {
                color: #16a34a;
            }

            [data-theme="light"] .hljs-number,
            [data-theme="light"] .hljs-literal {
                color: #ea580c;
            }

            [data-theme="light"] .hljs-comment {
                color: #94a3b8;
            }

            [data-theme="light"] .hljs-function .hljs-title,
            [data-theme="light"] .hljs-title.function_ {
                color: #2563eb;
            }

            [data-theme="light"] .hljs-variable,
            [data-theme="light"] .hljs-template-variable {
                color: #1e293b;
            }

            [data-theme="light"] .hljs-params {
                color: #475569;
            }

            [data-theme="light"] .hljs-property {
                color: #0d9488;
            }

            [data-theme="light"] .hljs-punctuation {
                color: #6366f1;
            }

            [data-theme="light"] .hljs-meta {
                color: #d97706;
            }

            [data-theme="light"] .hljs-selector-class {
                color: #d97706;
            }

            [data-theme="light"] .hljs-selector-id {
                color: #2563eb;
            }

            [data-theme="light"] .hljs-attribute {
                color: #7c3aed;
            }

            [data-theme="light"] .hljs-regexp {
                color: #6366f1;
            }

            [data-theme="light"] .hljs-addition {
                color: #16a34a;
            }

            [data-theme="light"] .hljs-deletion {
                color: #dc2626;
            }

            .hljs-property {
                color: #80cbc4;
            }

            .hljs-punctuation {
                color: #89ddff;
            }

            .hljs-meta {
                color: #ffcb6b;
            }

            .hljs-selector-class {
                color: #ffcb6b;
            }

            .hljs-selector-id {
                color: #82aaff;
            }

            .hljs-attribute {
                color: #c792ea;
            }

            .hljs-regexp {
                color: #89ddff;
            }

            .hljs-addition {
                color: #c3e88d;
            }

            .hljs-deletion {
                color: #ff5370;
            }

            /* ─── Error ──────────────────────────────────────── */

            .error {
                padding: 40px;
                text-align: center;
                color: var(--text-dim);
            }

            .error__title {
                font-size: 22px;
                font-weight: 600;
                color: var(--text-muted);
                margin-bottom: 8px;
            }

            .error__message {
                font-size: 17px;
                margin-bottom: 20px;
            }

            .error__link {
                color: var(--accent-text);
                text-decoration: none;
            }

            .error__link:hover {
                text-decoration: underline;
            }

            /* ─── Responsive: large screens ──────────────────── */

            @media (min-width: 1200px) {
                .md {
                    max-width: 920px;
                }
            }

            /* ─── Responsive ─────────────────────────────────── */

            @media (max-width: 900px) {
                .md {
                    padding: 32px 32px 60px;
                }
            }

            @media (max-width: 720px) {
                .md {
                    padding: 24px 20px 60px;
                    max-width: 100%;
                }

                .md h1 {
                    font-size: 28px;
                }

                .md h2 {
                    font-size: 22px;
                    margin-top: 36px;
                }

                .md h3 {
                    font-size: 18px;
                    margin-top: 24px;
                }

                .md h4 {
                    font-size: 15px;
                }

                .md pre {
                    padding: 12px 14px;
                }

                .md pre code {
                    font-size: 14px;
                }

                .md table {
                    font-size: 14px;
                }

                .md thead th {
                    font-size: 13px;
                }

                .md tbody td code {
                    font-size: 13px;
                }

                .md pre code {
                    word-break: break-all;
                    white-space: pre-wrap;
                }

                .md table {
                    display: block;
                    overflow-x: auto;
                    -webkit-overflow-scrolling: touch;
                }

                .md table thead,
                .md table tbody,
                .md table tr {
                    display: table;
                    width: 100%;
                    table-layout: fixed;
                }
            }
        </style>
    </head>
    <body>
        <!-- ─── Header ───────────────────────────────────── -->

        <header class="header">
            <div class="header__inner">
                <a href="/" class="header__logo">VList</a>
                <span class="header__sep">/</span>
                <span class="header__section">Tutorials</span>
                <nav class="header__nav">
                    <a href="/examples/">Examples</a>
                    <a href="/docs/">Docs</a>
                    <a href="/tutorials/" class="active">Tutorials</a>
                    <a href="/benchmarks/">Benchmarks</a>
                    <!-- a href="/api">API</a-->
                    <a href="https://github.com/floor/vlist" target="_blank"
                        >GitHub</a
                    >
                </nav>
                <button
                    class="header__theme"
                    id="theme-toggle"
                    aria-label="Toggle theme"
                >
                    <svg
                        class="header__theme-sun"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    >
                        <circle cx="12" cy="12" r="5" />
                        <line x1="12" y1="1" x2="12" y2="3" />
                        <line x1="12" y1="21" x2="12" y2="23" />
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                        <line x1="1" y1="12" x2="3" y2="12" />
                        <line x1="21" y1="12" x2="23" y2="12" />
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                    </svg>
                    <svg
                        class="header__theme-moon"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    >
                        <path
                            d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                        />
                    </svg>
                </button>
                <button
                    class="header__hamburger"
                    id="hamburger"
                    aria-label="Toggle menu"
                >
                    <svg
                        width="20"
                        height="20"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                    >
                        <rect y="3" width="20" height="2" rx="1" />
                        <rect y="9" width="20" height="2" rx="1" />
                        <rect y="15" width="20" height="2" rx="1" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- ─── Overlay ──────────────────────────────────── -->

        <div class="overlay" id="overlay"></div>

        <!-- ─── Layout ───────────────────────────────────── -->

        <div class="layout">
            <nav class="sidebar" id="sidebar">{{SIDEBAR}}</nav>

            <main class="content">{{CONTENT}}</main>

            {{TOC}}
        </div>

        <!-- ─── Syntax highlighting (client-side) ────────── -->

        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/languages/typescript.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/languages/bash.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/languages/css.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/languages/scss.min.js"></script>
        <script>
            hljs.highlightAll();
        </script>

        <!-- ─── Mobile toggle ────────────────────────────── -->

        <script>
            (function () {
                var h = document.getElementById("hamburger");
                var s = document.getElementById("sidebar");
                var o = document.getElementById("overlay");
                if (!h) return;
                function toggle() {
                    s.classList.toggle("sidebar--open");
                    o.classList.toggle("overlay--visible");
                }
                function close() {
                    s.classList.remove("sidebar--open");
                    o.classList.remove("overlay--visible");
                }
                h.addEventListener("click", toggle);
                o.addEventListener("click", close);
                s.addEventListener("click", function (e) {
                    if (e.target.closest("a")) close();
                });
            })();
        </script>

        <!-- ─── Theme toggle ─────────────────────────────── -->

        <script>
            (function () {
                var btn = document.getElementById("theme-toggle");
                if (!btn) return;
                btn.addEventListener("click", function () {
                    var current =
                        document.documentElement.getAttribute("data-theme");
                    var next = current === "light" ? "dark" : "light";
                    document.documentElement.setAttribute("data-theme", next);
                    localStorage.setItem("vlist-theme", next);
                });
            })();
        </script>

        <!-- ─── TOC active link highlighting ─────────────── -->

        <script>
            (function () {
                var toc = document.querySelector(".toc");
                if (!toc) return;

                var links = Array.from(toc.querySelectorAll(".toc__link"));
                if (links.length === 0) return;

                // Get all heading elements
                var headings = links
                    .map(function (link) {
                        var id = link.getAttribute("href").slice(1);
                        return document.getElementById(id);
                    })
                    .filter(Boolean);

                if (headings.length === 0) return;

                // Update active link based on scroll position
                function updateActive() {
                    var scrollPos = window.scrollY + 100; // offset for header
                    var current = null;

                    // Check if we're at the bottom of the page
                    var isAtBottom =
                        window.innerHeight + window.scrollY >=
                        document.documentElement.scrollHeight - 10;

                    if (isAtBottom) {
                        // If at bottom, activate the last heading
                        current = headings[headings.length - 1];
                    } else {
                        // Find the heading closest to top of viewport
                        for (var i = headings.length - 1; i >= 0; i--) {
                            if (headings[i].offsetTop <= scrollPos) {
                                current = headings[i];
                                break;
                            }
                        }
                    }

                    // Update active state
                    links.forEach(function (link) {
                        var id = link.getAttribute("href").slice(1);
                        if (current && current.id === id) {
                            link.classList.add("toc__link--active");
                        } else {
                            link.classList.remove("toc__link--active");
                        }
                    });
                }

                // Throttle scroll events
                var ticking = false;
                window.addEventListener("scroll", function () {
                    if (!ticking) {
                        window.requestAnimationFrame(function () {
                            updateActive();
                            ticking = false;
                        });
                        ticking = true;
                    }
                });

                // Initial update
                updateActive();
            })();
        </script>
    </body>
</html>
